<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css_py/css.css">
    <title>命令执行攻击与防御</title>
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script>
        $(document).ready(function ()
        {
            $(".Sidemenu ul li").hide();
            $("#side1").click(function () {
                $(".hide1").slideToggle(800)
            });
            $("#side2").click(function () {
                $(".hide2").slideToggle(800)
            });
            $("#side3").click(function () {
                $(".hide3").slideToggle(800)
            });
            $("#side4").click(function () {
                $(".hide4").slideToggle(800)
            });
            $("#side5").click(function () {
                $(".hide5").slideToggle(800)
            });
            $("#side0").click(function () {
                $(".Sidemenu ul li").fadeToggle();
            });
            $("#title").click(function () {
                $(".Sidemenu,#side0").fadeToggle();
            });
            $("#top").hide();
            $(function() {
                $(window).scroll(function() {
                    if ($(window).scrollTop() > 200) {
                        $("#top").fadeIn(500);
                    } else {
                        $("#top").fadeOut(500);
                    }
                });
                $("#top").click(function() {
                    $('body,html').animate({scrollTop: 0}, 500);
                })
            })

        })
    </script>
    <style>
        .text{
            box-shadow: 1px 1px 5px grey;
        }
    </style>
</head>
<body>
<div id="top">回到顶部</div>
<div class="menu">
    <ul>
        <li>
            <p href="" class="head" id="title">Web网络安全</p>
        </li>

        <li id="title1">
            <a href="#" class="head">基础知识</a>
            <ul id="a">
                <li><a href="">Web安全基础</a></li>
            </ul>
        </li>

        <li id="title2">
            <a href="#" class="head">网络攻击的基本防护与方法</a>
            <ul id="b">
                <li><a href="xss.html" target="_blank">XSS攻击</a></li>
                <li><a href="">请求伪造漏洞与防护</a></li>
                <li><a href="">SQL注入</a></li>
                <li><a href="文件上传攻击.html" target="_blank">文件上传攻击</a></li>
                <li><a href="">Web木马的原理</a></li>
                <li><a href="">文件包含攻击</a></li>
                <li><a href="命令执行攻击与防御.html" target="_blank">命令执行攻击与防御</a></li>
            </ul>
        </li>

        <li id="title3">
            <a href="#" class="head">业务逻辑安全</a>
            <ul id="c">
                <li><a href="">业务逻辑安全风险存在的前提</a></li>
                <li><a href="">用户管理功能的实现</a></li>
                <li><a href="">用户授权管理及安全分析</a></li>
                <li><a href="">用户身份识别技术及安全防护</a></li>
                <li><a href="">用户权限处理问题</a></li>
                <li><a href="">业务流程安全基础防护方式总结</a></li>
            </ul>
        </li>

        <li id="title4">
            <a href="#" class="head">攻防视角下的Web安全防护</a>
            <ul id="d">
                <li><a href="">标准业务场景</a></li>
                <li><a href="">用户视角下的所见范围探测</a></li>
                <li><a href="">用户视角下的防护手段识别</a></li>
                <li><a href="">常用防护方案</a></li>
            </ul>
        </li>

        <li id="title5">
            <a href="#" class="head" id="66">Web防护技术及开展方法</a>
            <ul id="e">
                <li><a href="">Web防护技术的演进</a></li>
                <li><a href="">Web安全防护体系建议</a></li>
                <li><a href="">渗透测试的方法及流程</a></li>
                <li><a href="">快速代码审计实验</a></li>
            </ul>
        </li>
    </ul>
</div>

<div class="search" id="container">
    <form id="form" action="../css_py/search.py" method="get">
        <input id="search1" type="text" placeholder="search">
    </form>
</div>

<p href="" class="head" id="side0">Web网络安全</p>
<div class="Sidemenu">
    <ul>
        <li id="side_title1">
            <p class="side_head" id="side1" style="border-top-left-radius: 5%;border-top-right-radius: 5%">基础知识</p>
            <ul id="side_" class="hide1">
                <li id="side_a"><a href="">Web安全基础</a></li>
            </ul>
        </li>

        <li id="side_title2">
            <p class="side_head" id="side2">网络攻击的基本防护与方法</p>
            <ul id="side_b" class="hide2" style="display: block">
                <li><a href="xss.html" target="_blank">XSS攻击</a></li>
                <li><a href="">请求伪造漏洞与防护</a></li>
                <li><a href="">SQL注入</a></li>
                <li><a href="文件上传攻击.html" target="_blank">文件上传攻击</a></li>
                <li><a href="">Web木马的原理</a></li>
                <li><a href="">文件包含攻击</a></li>
                <li style="background-color: #a2a2a2"><a href="命令执行攻击与防御.html" target="_blank">命令执行攻击与防御</a></li>
            </ul>
        </li>

        <li id="side_title3">
            <p class="side_head" id="side3">业务逻辑安全</p>
            <ul id="side_c" class="hide3">
                <li><a href="">业务逻辑安全风险存在的前提</a></li>
                <li><a href="">用户管理功能的实现</a></li>
                <li><a href="">用户授权管理及安全分析</a></li>
                <li><a href="">用户身份识别技术及安全防护</a></li>
                <li><a href="">用户权限处理问题</a></li>
                <li><a href="">业务流程安全基础防护方式总结</a></li>
            </ul>
        </li>

        <li id="side_title4">
            <p class="side_head" id="side4">攻防视角下的Web安全防护</p>
            <ul id="side_d" class="hide4">
                <li><a href="">标准业务场景</a></li>
                <li><a href="">用户视角下的所见范围探测</a></li>
                <li><a href="">用户视角下的防护手段识别</a></li>
                <li><a href="">常用防护方案</a></li>
            </ul>
        </li>

        <li id="side_title5">
            <p class="side_head" id="side5">Web防护技术及开展方法</p>
            <ul id="side_e" class="hide5">
                <li><a href="">Web防护技术的演进</a></li>
                <li><a href="">Web安全防护体系建议</a></li>
                <li><a href="">渗透测试的方法及流程</a></li>
                <li><a href="">快速代码审计实验</a></li>
            </ul>
        </li>
    </ul>
</div>
<br>
<br>
<br>
<div class="text_body">
<h2 style="text-align: center;top: -10px">命令执行攻击与防御</h2>
<div class="text">
    <h4>简介</h4>
    <pre style="color: black;font-size: 14px">
    Command Injection，即命令注入攻击，是指这样一种攻击手段，黑客通过把HTML代码输入一个输入机制(例如缺乏有效验证限制的表格域)来改变网页的动态生成的内容。
    </pre>
</div>
<br>
<br>
<div class="text">
    <h4>原理</h4>
    <pre style="color: black;font-size: 14px">
    Command Injection，即命令注入攻击，是指这样一种攻击手段，黑客通过把HTML代码输入一个输入机制(例如缺乏有效验证限制的表格域)来改变网页的动态生成的内容。一个恶意黑客(也被称为
    破裂者cracker)可以利用这种攻击方法来非法获取数据或者网络资源。当用户进入一个有命令注入漏洞的网页时，他们的浏览器会通译那个代码，而这样就可能会导致恶意命令掌控该用户的电脑和
    他们的网络。
    </pre>
</div>
<br>
<hr>
<br>
<div style="box-shadow: 1px 1px 5px grey">
    <p style="text-align: center;font-size: 18px;color:black;">以下是四个等级的后端防护代码，如果你看懂了代码，你就知道如何进行攻击和防范</p>
</div>
<br>
<br>
<p style="color: black;text-align: center">Low Command Injection Source</p>
<div class="text">
    <code><pre>
    if( isset( $_POST[ 'Submit' ]  ) ) {
    // Get input
    $target = $_REQUEST[ 'ip' ];

    // Determine OS and execute the ping command.
    if( stristr( php_uname( 's' ), 'Windows NT' ) ) {
        // Windows
        $cmd = shell_exec( 'ping  ' . $target );
    }
    else {
        // *nix
        $cmd = shell_exec( 'ping  -c 4 ' . $target );
    }

    // Feedback for the end user
    echo "&lt;pre>{$cmd}&lt;/pre>";
}
    </pre></code>
</div>
<br>
<br>
<p style="color: black;text-align: center">Medium Command Injection Source</p>
<div class="text">
    <code><pre>
    if( isset( $_POST[ 'Submit' ]  ) ) {
    // Get input
    $target = $_REQUEST[ 'ip' ];

    // Set blacklist
    $substitutions = array(
        '&&' => '',
        ';'  => '',
    );

    // Remove any of the charactars in the array (blacklist).
    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );

    // Determine OS and execute the ping command.
    if( stristr( php_uname( 's' ), 'Windows NT' ) ) {
        // Windows
        $cmd = shell_exec( 'ping  ' . $target );
    }
    else {
        // *nix
        $cmd = shell_exec( 'ping  -c 4 ' . $target );
    }

    // Feedback for the end user
    echo "&lt;pre>{$cmd}&lt;/pre>";
}
    </pre></code>
</div>
<br>
<br>
<p style="color: black;text-align: center">High Command Injection Source</p>
<div class="text">
    <code><pre>
    if( isset( $_POST[ 'Submit' ]  ) ) {
    // Get input
    $target = trim($_REQUEST[ 'ip' ]);

    // Set blacklist
    $substitutions = array(
        '&'  => '',
        ';'  => '',
        '| ' => '',
        '-'  => '',
        '$'  => '',
        '('  => '',
        ')'  => '',
        '`'  => '',
        '||' => '',
    );

    // Remove any of the charactars in the array (blacklist).
    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );

    // Determine OS and execute the ping command.
    if( stristr( php_uname( 's' ), 'Windows NT' ) ) {
        // Windows
        $cmd = shell_exec( 'ping  ' . $target );
    }
    else {
        // *nix
        $cmd = shell_exec( 'ping  -c 4 ' . $target );
    }

    // Feedback for the end user
    echo "&lt;pre>{$cmd}&lt;/pre>";
}

    </pre></code>
</div>
<br>
<br>
<p style="color: black;text-align: center">Impossible Command Injection Source</p>
<div class="text">
    <code><pre>
    if( isset( $_POST[ 'Submit' ]  ) ) {
    // Check Anti-CSRF token
    checkToken( $_REQUEST[ 'user_token' ], $_SESSION[ 'session_token' ], 'index.php' );

    // Get input
    $target = $_REQUEST[ 'ip' ];
    $target = stripslashes( $target );

    // Split the IP into 4 octects
    $octet = explode( ".", $target );

    // Check IF each octet is an integer
    if( ( is_numeric( $octet[0] ) ) && ( is_numeric( $octet[1] ) ) && ( is_numeric( $octet[2] ) ) && ( is_numeric( $octet[3] ) ) && ( sizeof( $octet ) == 4 ) ) {
        // If all 4 octets are int's put the IP back together.
        $target = $octet[0] . '.' . $octet[1] . '.' . $octet[2] . '.' . $octet[3];

        // Determine OS and execute the ping command.
        if( stristr( php_uname( 's' ), 'Windows NT' ) ) {
            // Windows
            $cmd = shell_exec( 'ping  ' . $target );
        }
        else {
            // *nix
            $cmd = shell_exec( 'ping  -c 4 ' . $target );
        }

        // Feedback for the end user
        echo "&lt;pre>{$cmd}&lt;/pre>";
    }
    else {
        // Ops. Let the user name theres a mistake
        echo '&lt;pre>ERROR: You have entered an invalid IP.&lt;/pre>';
    }
}
// Generate Anti-CSRF token
generateSessionToken();
    </pre></code>
</div>
</div>

<br>
</body>
</html>